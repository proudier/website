---
layout: post
title: A free virtualization platform with a web-interface
categories:
- Administration
tags:
- CentOS
- RedHat
- RHEL
- Virtualization
- VirtualBox
comments: []
---
<p>In this post, we will put together a headless installation of VirtualBox, the VirtualBox web services and a we will install&nbsp;phpVirtualBox on RedHat.</p>
<p><!--more--></p>
<h1>VirtualBox</h1>
<p>Oracle provides a <a href="http://download.virtualbox.org/virtualbox/rpm/rhel/virtualbox.repo" target="_blank" rel="noopener">repository</a>&nbsp;but the servers were so slow that I had to download directly the rpm file from the <a href="https://www.virtualbox.org/wiki/Linux_Downloads" target="_blank" rel="noopener">download page</a>. That's a pity, i'll have to deal with the updates myself. Anyway, make sure you download the right rpm: <em>Oracle Linux 6 ("OL6") / Red Hat Enterprise Linux 6 ("RHEL6") / CentOS 6&nbsp;</em><em>AMD64</em> in my case.</p>
<pre>yum install&nbsp;VirtualBox-4.3-4.3.2_90405_el6-1.x86_64.rpm</pre>
<p>Now you have to setup the kernel module. To do so, you'll need to have some dependencies installed</p>
<pre>yum install kernel-devel dkms</pre>
<p>Having your system updated will help avoiding troubles. &nbsp;Now for the real thing:</p>
<pre>service vboxdrv setup</pre>
<p>If compilation fails, make sure the kernel version&nbsp;your are running correspond to the latest version installed on your system. Such a discrepancy can occur if you have updated your kernel but have not restarted the server yet.</p>
<h1>VirtualBox Extension Pack</h1>
<p>Given our current target, you might be interested in the features offered by the extension pack:</p>
<ul>
<li>VirtualBox RDP</li>
<li>PXE boot for Intel cards</li>
</ul>
<p>If you are not interested you can skip this section. Else, download the pack from the <a href="https://www.virtualbox.org/wiki/Linux_Downloads" target="_blank" rel="noopener">download page</a> and push it to your server or</p>
<pre>wget&nbsp;http://download.virtualbox.org/virtualbox/4.3.2/Oracle_VM_VirtualBox_Extension_Pack-4.3.2-90405.vbox-extpack</pre>
<p>Then install it</p>
<pre>VBoxManage extpack install&nbsp;Oracle_VM_VirtualBox_Extension_Pack-4.3.2-90405.vbox-extpack</pre>
<p>Note: this command will fail if an older version of the same extension pack is already installed. The optional --replace parameter can be used to uninstall the old package before the new package is installed. See <a href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-extpack" target="_blank" rel="noopener">manual</a>.</p>
<h1>VirtualBox Web Service</h1>
<p>If you try to start the webservice at this point, you be very disappointed: it won't start and won't give any explanation. Looking at the startup script&nbsp;<code>/etc/init.d/vboxweb-service</code>, I found the source of this behavior:</p>
<pre>[ -z "$VBOXWEB_USER" ] &amp;&amp; exit 0</pre>
<p>The script being fairly organized, one can easily understand this variable is supposed to be defined in&nbsp;<code>/etc/vbox/vbox.cfg</code>.</p>
<p>Create a user, set its password and edit <code>vbox.cfg</code>:</p>
<pre>useradd -g vboxusers -N&nbsp;vboxws
passwd vboxws 
mkdir /etc/vbox/
echo "VBOXWEB_USER=vboxws" >> /etc/vbox/vbox.cfg</pre>
<p>Now you can (re)start the service</p>
<pre>service vboxweb-service restart</pre>
<h1>phpVirtualBox</h1>
<p>I'll assume you've already set up a running web server that serves files from <code>/var/www/html/</code> and have PHP enabled.</p>
<p>Download the archive from <a href="http://sourceforge.net/projects/phpvirtualbox/" target="_blank" rel="noopener">SourceForge</a>. Be careful to download the version corresponding to your version of Virtualbox.</p>
<pre>mkdir&nbsp;/var/www/html/phpvirtualbox
cd /var/www/html/phpvirtualbox
unzip&nbsp;phpvirtualbox-4.3-0.zip
cp config.php-example config.php
sed -i "s/$username = 'vbox'/$username = 'vboxws'/"&nbsp;config.php
sed -i "s/$password= 'pass'/$password= 'my-password'/"&nbsp;config.php</pre>
<p>phpVirtualBox required the PHP SOAP module.</p>
<pre>yum install php-soap</pre>
<p>Now, using your browser, you can connect to phpVirtualBox. The default login/password is admin/admin.</p>
<p>Enjoy!</p>
<p>&nbsp;</p>
