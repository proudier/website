---
layout: post
title: 'iostat: How %util is computed?'
categories:
- Administration
tags:
- Linux
- Storage
comments: []
---
<p>I was wondering what %util precisely meant. Once again, <a href="http://stackoverflow.com/" target="_blank">StackOverflow</a> came to the rescue! Here is a summary.<!--more--></p>
<p>Basically, <strong>%util is the ratio of time spent doing I/Os to the total elapsed time</strong>.</p>
<p>&nbsp;</p>
<p>The kernel keeps track of how many request left a device has to perform. From this measurement, the kernel is able to compute how much time the device had something to do.</p>
<p>This information are accessible from userspace via the 9th and the 10th fields of <code><a href="http://www.kernel.org/doc/Documentation/iostats.txt" target="_blank">/proc/diskstats</a>:</code></p>
<blockquote><p>Field&nbsp; 9 -- # of I/Os currently in progress [&hellip;]<br />
Incremented as requests are given to appropriate struct request_queue and decremented as they finish.</p>
<p>Field 10 -- # of milliseconds spent doing I/Os<br />
This field increases so long as field 9 is nonzero.</p></blockquote>
<p>&nbsp;</p>
<p>The elapsed time is based on the CPU time and is computed using data from /proc/stat according to the formula:<br />
<code>cpu time = (user time + system time + idle time + iowait) / number of CPU</code></p>
<p>&nbsp;</p>
<p>Now you should be able to understand ioctl's man page</p>
<blockquote><p>%util: Percentage&nbsp; of&nbsp; CPU&nbsp; time during which I/O requests were issued to the device (bandwidth utilization for the device).</p></blockquote>
<p>Original thread: <a href="http://stackoverflow.com/questions/4458183/how-the-util-of-iostat-is-computed" target="_blank">http://stackoverflow.com/questions/4458183/how-the-util-of-iostat-is-computed</a></p>
